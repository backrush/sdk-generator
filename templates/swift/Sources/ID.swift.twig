import Foundation

// Generate a unique ID based on timestamp
// Recreated from https://www.php.net/manual/en/function.uniqid.php
func uniqueId() -> String {
    let now = Date()
    let secondsSinceEpoch = Int(now.timeIntervalSince1970)
    let microsecondsPart = Int((now.timeIntervalSince1970 - Double(secondsSinceEpoch)) * 1_000_000)
    let hexTimestamp = String(format: "%08x%05x", secondsSinceEpoch, microsecondsPart)
    return hexTimestamp
}

public class ID {
    public static func custom(_ id: String) -> String {
        return id
    }

    // Generate a unique ID with padding to have a longer ID
    // Recreated from https://github.com/utopia-php/database/blob/main/src/Database/ID.php#L13
    public static func unique(padding: Int = 7) -> String {
        let baseId = uniqueId()
        let randomPadding = (1...padding).map {
            _ in String(format: "%x", Int.random(in: 0..<16))
        }.joined()
        return baseId + randomPadding
    }
}
