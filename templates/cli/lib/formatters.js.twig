const chalk = require('chalk');
const dots = ["⣾", "⣽", "⣻", "⢿", "⡿", "⣟", "⣯", "⣷"];

const formatterFunction = (options, params, payload) => {
    const status = payload.status.padEnd(12);
    const middle = `${payload.function} (${payload.id})`.padEnd(40);

    let start = chalk.blue(status);
    let end = chalk.yellow(`Ignoring using: ${payload.ignore}`);
    let progress = '⌛';

    if (status.toLowerCase().trim() === 'deployed') {
        start = chalk.green.bold(status);
        progress = chalk.green.bold('✓'.padEnd(2))
    } else if (status.toLowerCase().trim() === 'error') {
        start = chalk.red.bold(status);
        progress = chalk.red.bold('✗'.padEnd(2))
        end = chalk.red(payload.errorMessage);
    }

    if (payload.progress && Number.isInteger(payload.progress)) {
        progress = dots[payload.progress - 1].padEnd(2);
    }

    return formatter(start, middle, end, progress);
}

const formatter = (start, middle, end, progress, separator = '•') => {
    return `${progress}${start} ${separator} ${middle} ${separator} ${end}`;

}

module.exports = {
    formatterFunction
}
