using System;

namespace {{ spec.title | caseUcfirst }}
{
    public static class ID
    {
        // Generate a unique ID based on timestamp
        // Recreated from https://www.php.net/manual/en/function.uniqid.php
        private static string uniqueId()
        {
            var now = DateTime.UtcNow;
            var secondsSinceEpoch = (long)(now - new DateTime(1970, 1, 1)).TotalSeconds;
            var msecs = (now - new DateTime(1970, 1, 1)).TotalMilliseconds - secondsSinceEpoch * 1000;
            var microsecondsPart = (long)(msecs * 1000); // Convert milliseconds to microseconds

            // Convert to hexadecimal
            var hexTimestamp = secondsSinceEpoch.ToString("x") + microsecondsPart.ToString("x").PadLeft(5, '0');
            return hexTimestamp;
        }

        // Generate a unique ID with padding to have a longer ID
        // Recreated from https://github.com/utopia-php/database/blob/main/src/Database/ID.php#L13
        public static string Unique(int padding = 7)
        {
            var random = new Random();
            var baseId = uniqueId();
            var randomPadding = "";

            for (int i = 0; i < padding; i++)
            {
                var randomHexDigit = random.Next(0, 16).ToString("x");
                randomPadding += randomHexDigit;
            }

            return baseId + randomPadding;
        }

        public static string Custom(string id)
        {
            return id;
        }
    }
}
